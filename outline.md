## 機能モデル

### 戦略

ダブルループNEO(以下ダブルループと記載する)を攻略するために、コースの形状と走行方法に基づいて走行区間を9つのシーンに分割した。9つのシーンの経路と概要を図1.1、表1.1に示す。各シーンの終了条件にはダブルループに存在する青色マーカーの検出を用いる。

### 要求分析とリスク分析

基本戦略に必要な機能とリスクを分析しユースケース図（図1.2）とユースケース記述（表1.2）に示した。ループの攻略にはライントレース走行、エッジの切り替え、切り替え契機の検出のための色の検出が必要であると考えた。これらを脅かすミスアクターとしてカラーセンサーでライントレースをする場合カラーセンサーが読み取れる範囲が狭いこと、環境光に差異が生じることを挙げ、それらに対する緩和策を施した。

なお、エッジ切り替え準備のための低速走行を「遅ライントレース」、それ以外の走行を「速ライントレース」と呼称する。

### 処理フロー

表1.2の基本フローについてアクティビティ図で示した。

## 構造モデル

### 構造方針及びパッケージの役割分担

機能実現のため、システムをハードウェアに近い層から競技者に近い層まで4つのレイヤに分割した。また、役割の分類から7つのパッケージを設計した。これらのパッケージとレイヤをパッケージ図（図2.1）に示す。次に、各パッケージの役割をパッケージ図の説明（表2.1）に示す。

### クラス構造

構造方針とパッケージの役割分担をもとにクラス図の設計を行った。設計したクラスをクラス図（図2.2）に示す。なお、ダブルループ攻略に関係しないクラスについては、紙面の都合上省略する。

## 各パッケージの役割

| パッケージ名 | 役割 |
| ----------- | --- |
| シナリオ管理 | 各シナリオの管理を行う。 |
| 判定 | シナリオ切り替えの判定を行う。 |
| 動作 | 走行体の動作を行う。 |
| 情報 | 取得した値を処理する。 |
| デバイスマネージャー | 各デバイスの管理を行う。 |
| Spikeデバイス | モータの値を取得、設定する。 |
| カメラデバイス | カメラモジュールからフレームを取得する。 |

### シナリオ管理
各シナリオの管理を行う。

### 判定
シナリオ切り替えの判定を行う。

### 動作
走行体の制御を行う。

### 情報
取得した値の処理を行う。

### デバイスマネージャー
各デバイスの管理を行う。

### Spikeデバイス
モータの値を取得、設定する。

### カメラデバイス
カメラモジュールからフレームを取得する。


## 振る舞いモデル

### ダブルループ攻略シナリオの振舞い

機能モデル、構造モデルに基づき、シナリオ開始から青サークル検出によるシナリオ終了までのシナリオクラスの振る舞いをステートマシン図に示す（図3.1）。

### シナリオシーケンサーの振る舞い

ダブルループ進入準備シーンを例に、シナリオシーケンサーがシーンを実行する一連の流れをシーケンス図に示す（図3.2 - 図3.5）。なお、ほかのシーンの振舞いは紙面の都合上省略する。

